<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jy Workout</title>

<style>
/* ================== ROOT ================== */
:root{
  --brand:#2453f5;
  --ink:#0f172a;
  --sub:#64748b;

  --bgTop:#ffffff;
  --bgBottom:#ffffff;

  --card:#ffffff;
  --shadow-soft:0 18px 48px rgba(15,23,42,0.12);

  --tag-purple-bg:#ede9fe; --tag-purple-ink:#6d28d9;
  --tag-green-bg:#dcfce7;  --tag-green-ink:#16a34a;
  --tag-blue-bg:#e4ecff;   --tag-blue-ink:#2453f5;
  --tag-pink-bg:#ffe4f1;   --tag-pink-ink:#be185d;
  --tag-orange-bg:#ffe6bf; --tag-orange-ink:#b45309;
  --tag-teal-bg:#d1fae5;   --tag-teal-ink:#0f766e;
  --tag-red-bg:#ffe0e0;    --tag-red-ink:#dc2626;
  --tag-yellow-bg:#fef3c7; --tag-yellow-ink:#a16207;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro",Segoe UI,Roboto,sans-serif;
  color:var(--ink);
  background:linear-gradient(180deg,var(--bgTop),var(--bgBottom));
  overflow:hidden;
}

.container{
  max-width:520px;
  margin:0 auto;
  padding:18px 18px 0;
  height:100vh;
  display:flex;
  flex-direction:column;
}

/* ================== CENTER ================== */
.center{
  position:relative;
  flex:1;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding-top:18px;
}

/* ================== WEEKLY ================== */
.weekly-center{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}
.weekly-center.hidden{ display:none; }

.weekly-count{ text-align:center; }
.weekly-count .num{
  font-size:150px;
  font-weight:900;
  color:rgba(15,23,42,0.08);
  line-height:.9;
}
.weekly-count .label{
  margin-top:10px;
  font-size:16px;
  color:rgba(100,116,139,.65);
  display:flex;
  justify-content:center;
  gap:8px;
}
.streak-inline{ font-weight:500; color:#0f172a; }

/* ================== CARD ================== */
.card{
  width:100%;
  background:#fff;
  border-radius:22px;
  box-shadow:var(--shadow-soft);
  padding:22px;
  display:none;
}
.card.visible{ display:block; }

.card-title{
  font-size:20px;
  font-weight:600;
  margin-bottom:16px;
}

.row{
  display:flex;
  justify-content:space-between;
  padding:10px 0;
}
.row-text{ font-size:16px; }

/* ================== ACTIONS ================== */
.actions{
  padding-bottom:18px;
  transform:translateY(-1.5rem);
}
.btn{
  width:100%;
  height:52px;
  border:none;
  border-radius:999px;
  font-size:18px;
  font-weight:600;
  background:var(--brand);
  color:#fff;
}
.btn.secondary{
  background:#eef2f7;
  color:var(--brand);
  margin-top:12px;
}

/* ================== CONFETTI ================== */
#confettiCanvas{
  position:fixed;
  inset:0;
  pointer-events:none;
}

/* ================== MODAL ================== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.3);
  display:none;
}
.modal.show{ display:block; }
.modal-sheet{
  position:absolute;
  inset:0;
  background:#fff;
  display:flex;
  flex-direction:column;
}
.modal-head{
  padding:16px;
  display:flex;
  justify-content:space-between;
}
.modal-body{
  padding:16px;
  overflow:auto;
  flex:1;
}
</style>
</head>

<body>
<canvas id="confettiCanvas"></canvas>

<div class="container">
  <div class="center">

    <div class="weekly-center" id="weeklyCenter">
      <div class="weekly-count">
        <div class="num" id="weekNum">0</div>
        <div class="label">
          <span>workouts completed</span>
          <span>Â·</span>
          <span class="streak-inline" id="streakInline">0 week streak</span>
        </div>
      </div>
    </div>

    <div class="card" id="card">
      <div class="card-title" id="cardTitle"></div>
      <div id="cardRows"></div>
    </div>

  </div>

  <div class="actions">
    <button class="btn" id="generateBtn">Generate Workout</button>
    <button class="btn secondary" id="testDayBtn">Test Day</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
/* ================== STORAGE ================== */
const LS={
  total:"jy_total_days",
  last:"jy_last_day",
  streak:"jy_streak",
  week:"jy_week",
  weekCount:"jy_week_count"
};

/* ================== UTIL ================== */
const qs=s=>document.querySelector(s);
const todayKey=()=>new Date().toISOString().slice(0,10);

/* ================== WEEK ================== */
function isoWeek(){
  const d=new Date();
  d.setHours(0,0,0,0);
  d.setDate(d.getDate()+4-(d.getDay()||7));
  const y=new Date(d.getFullYear(),0,1);
  return d.getFullYear()+"-"+Math.ceil((((d-y)/86400000)+1)/7);
}

/* ================== STATE ================== */
let testStart=null;
const TEST_WORKOUT=[
"50 Pull-Ups","50 Dips","100 Jumping Squats","50 Pike Push-Ups","50 Push-Ups",
"100 Full Body Crunches","50 Kettlebell Swings","50 Australian Rows",
"100 Jumping Jacks","10 Muscle-Ups"
];

/* ================== UI ================== */
function renderWeekly(){
  qs("#weekNum").textContent=localStorage.getItem(LS.total)||0;
  qs("#streakInline").textContent=(localStorage.getItem(LS.streak)||0)+" week streak";
}

/* ================== AMRAP ================== */
function generateAMRAP(){
  return {
    type:"As Many Rounds As Possible",
    rows:["10 Push-Ups","10 Pull-Ups","20 Squats"]
  };
}

/* ================== TEST DAY ================== */
function startTestDay(){
  testStart=Date.now();
  showWorkout("Test Day",TEST_WORKOUT);
}

function endTestDay(){
  const today=todayKey();
  if(localStorage.getItem(LS.last)!==today){
    localStorage.setItem(LS.total,(+localStorage.getItem(LS.total)||0)+1);
    localStorage.setItem(LS.last,today);
  }

  const w=isoWeek();
  if(localStorage.getItem(LS.week)!==w){
    localStorage.setItem(LS.week,w);
    localStorage.setItem(LS.weekCount,0);
  }
  localStorage.setItem(LS.weekCount,(+localStorage.getItem(LS.weekCount)||0)+1);
  if(+localStorage.getItem(LS.weekCount)>=3){
    localStorage.setItem(LS.streak,(+localStorage.getItem(LS.streak)||0)+1);
  }

  confetti();
  showWeekly();
}

/* ================== RENDER ================== */
function showWorkout(title,rows){
  qs("#weeklyCenter").classList.add("hidden");
  const c=qs("#card");
  qs("#cardTitle").textContent=title;
  qs("#cardRows").innerHTML=rows.map(r=>`<div class="row"><div class="row-text">${r}</div></div>`).join("");
  c.classList.add("visible");
  qs("#generateBtn").style.display="none";
  qs("#testDayBtn").textContent="End Test Day";
  qs("#testDayBtn").onclick=endTestDay;
}

function showWeekly(){
  qs("#card").classList.remove("visible");
  qs("#weeklyCenter").classList.remove("hidden");
  qs("#generateBtn").style.display="block";
  qs("#testDayBtn").textContent="Test Day";
  qs("#testDayBtn").onclick=startTestDay;
  renderWeekly();
}

/* ================== EVENTS ================== */
qs("#generateBtn").onclick=()=>{
  const w=generateAMRAP();
  showWorkout(w.type,w.rows);
};
qs("#testDayBtn").onclick=startTestDay;

/* ================== INIT ================== */
renderWeekly();
</script>
</body>
</html>
